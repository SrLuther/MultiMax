{% extends 'base.html' %}
{% block title %}Sugestões de Promoção — MultiMax{% endblock %}
{% block content %}

<div class="mm-page-header mm-flex mm-items-center mm-justify-between mm-mb-6">
    <div>
        <h1 class="mm-page-title">Sugestões de Promoção</h1>
        <p class="mm-text-muted">Produtos próximos ao vencimento com sugestões de desconto</p>
    </div>
    <a href="{{ url_for('validade.index') }}" class="mm-btn mm-btn-outline">
        <i class="bi bi-arrow-left"></i>
        Voltar
    </a>
</div>

<div class="mm-card">
    <div class="mm-card-header">
        <h3 class="mm-card-title"><i class="bi bi-tag me-2"></i>Produtos para Promoção</h3>
        <span class="mm-badge mm-badge-primary">{{ sugestoes|length }}</span>
    </div>
    <div class="mm-card-body">
        {% if sugestoes and sugestoes|length > 0 %}
        <div class="mm-grid mm-grid-cols-3 mm-gap-4">
            {% for s in sugestoes %}
            <div class="mm-card" style="border: 1px solid var(--mm-border);">
                <div class="mm-card-body">
                    <div class="mm-flex mm-items-center mm-justify-between mm-mb-3">
                        <h4 style="margin: 0; font-size: 1rem;">{{ s.produto.nome }}</h4>
                        <span class="mm-badge {% if s.dias_restantes <= 3 %}mm-badge-danger{% elif s.dias_restantes <= 5 %}mm-badge-warning{% else %}mm-badge-info{% endif %}">
                            {{ s.dias_restantes }}d
                        </span>
                    </div>
                    <div class="mm-text-muted" style="font-size: var(--mm-text-sm); margin-bottom: var(--mm-space-3);">
                        Validade: {{ s.produto.data_validade.strftime('%d/%m/%Y') if s.produto.data_validade else '-' }}<br>
                        Estoque: {{ s.produto.quantidade }} un
                    </div>
                    <div style="background: var(--mm-bg-secondary); border-radius: var(--mm-radius); padding: var(--mm-space-3); margin-bottom: var(--mm-space-3);">
                        <div class="mm-flex mm-items-center mm-justify-between">
                            <span class="mm-text-muted">Preço original:</span>
                            <span style="text-decoration: line-through;">R$ {{ '%.2f'|format(s.preco_original) }}</span>
                        </div>
                        <div class="mm-flex mm-items-center mm-justify-between mm-mt-2">
                            <span style="color: var(--mm-success); font-weight: 600;">Preço sugerido:</span>
                            <span style="color: var(--mm-success); font-weight: 700; font-size: 1.25rem;">R$ {{ '%.2f'|format(s.preco_promocional) }}</span>
                        </div>
                    </div>
                    <div class="mm-flex mm-items-center mm-justify-center">
                        <span class="mm-badge mm-badge-primary" style="font-size: 1rem; padding: var(--mm-space-2) var(--mm-space-4);">
                            {{ s.desconto_sugerido }}% OFF
                        </span>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="mm-empty-state" style="text-align: center; padding: var(--mm-space-8);">
            <div style="width: 60px; height: 60px; margin: 0 auto var(--mm-space-4); background: rgba(34, 197, 94, 0.1); border-radius: var(--mm-radius-full); display: flex; align-items: center; justify-content: center;">
                <i class="bi bi-check-circle" style="font-size: 1.5rem; color: var(--mm-success);"></i>
            </div>
            <h4 class="mm-font-semibold mm-mb-2">Nenhum produto para promoção</h4>
            <p class="mm-text-muted">Não há produtos próximos ao vencimento no momento.</p>
        </div>
        {% endif %}
    </div>
</div>

{% endblock %}
