{% extends 'base.html' %}
{% block title %}Importar Registros Unificados - MultiMax{% endblock %}
{% block content %}
<div class="mm-page-header mm-mb-6">
    <div>
        <h1 class="mm-page-title">Importar Registros Unificados</h1>
        <p class="mm-text-muted">Importe horas extras, folgas adicionais e folgas usadas via arquivo Excel</p>
    </div>
    <a href="{{ url_for('relatorios.index') }}" class="mm-btn mm-btn-outline">
        <i class="bi bi-arrow-left"></i> Voltar
    </a>
</div>

<div class="mm-card">
    <div class="mm-card-body">
        <div class="mm-alert mm-alert-info" style="margin-bottom: var(--mm-space-4);">
            <i class="bi bi-info-circle"></i>
            <div>
                <strong>Instruções:</strong>
                <ul style="margin-top: var(--mm-space-2); margin-bottom: 0;">
                    <li>Use o modelo de planilha para garantir que os dados estejam no formato correto.</li>
                    <li>A primeira linha deve conter os cabeçalhos (será ignorada).</li>
                    <li><strong>ID Colaborador:</strong> ID numérico do colaborador no sistema</li>
                    <li><strong>Data:</strong> Formato DD/MM/YYYY (ex: 01/01/2025)</li>
                    <li><strong>Tipo:</strong> horas, folga_adicional, folga_usada ou conversao</li>
                    <li><strong>Horas:</strong> Apenas para tipo "horas" (número decimal, ex: 2.5)</li>
                    <li><strong>Dias:</strong> Para tipos de folga e conversão (número inteiro)</li>
                    <li><strong>Valor Pago:</strong> Apenas para tipo "conversao" (valor em R$)</li>
                    <li><strong>Taxa por Dia:</strong> Apenas para tipo "conversao" (padrão: 65.00)</li>
                    <li><strong>Origem:</strong> Opcional (ex: excel, manual, sistema)</li>
                    <li><strong>Observações:</strong> Texto opcional</li>
                </ul>
            </div>
        </div>
        
        <form action="{{ url_for('relatorios.importar_registros_unificados') }}" method="post" enctype="multipart/form-data">
            <div class="mm-form-group">
                <label class="mm-label">Arquivo Excel (.xlsx)</label>
                <input type="file" class="mm-input" name="arquivo" accept=".xlsx" required>
                <small class="mm-text-muted">Selecione um arquivo Excel no formato correto</small>
            </div>
            
            <div class="mm-flex mm-gap-3" style="margin-top: var(--mm-space-4);">
                <a href="{{ url_for('relatorios.modelo_registros_unificados') }}" class="mm-btn mm-btn-outline">
                    <i class="bi bi-download"></i> Baixar Modelo
                </a>
                <a href="{{ url_for('relatorios.exportar_registros_unificados') }}" class="mm-btn mm-btn-secondary">
                    <i class="bi bi-file-earmark-arrow-down"></i> Exportar Dados Atuais
                </a>
                <button type="submit" class="mm-btn mm-btn-primary">
                    <i class="bi bi-upload"></i> Importar Registros
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}







