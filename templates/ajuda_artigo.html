{% extends 'base.html' %}
{% block title %}{{ article.titulo }} — Ajuda — MultiMax{% endblock %}

{% block breadcrumb %}
<span class="mm-breadcrumb-separator">/</span>
<a href="{{ url_for('ajuda.ajuda') }}" class="mm-breadcrumb-link">Ajuda</a>
<span class="mm-breadcrumb-separator">/</span>
<span>{{ article.titulo[:30] }}{% if article.titulo|length > 30 %}...{% endif %}</span>
{% endblock %}

{% block content %}
<div class="mm-page-header mm-mb-6">
    <a href="{{ url_for('ajuda.ajuda') }}" class="mm-btn mm-btn-outline mm-mb-4">
        <i class="bi bi-arrow-left"></i> Voltar
    </a>
    <div class="mm-flex mm-items-center mm-gap-2 mm-mb-2">
        <span class="mm-badge mm-badge-primary">{{ article.categoria }}</span>
    </div>
    <h1 class="mm-page-title">{{ article.titulo }}</h1>
    <p class="mm-text-muted">
        {% if article.criado_por %}Por {{ article.criado_por }} • {% endif %}
        {{ article.criado_em.strftime('%d/%m/%Y') if article.criado_em else '' }}
    </p>
</div>

<div class="mm-card">
    <div class="mm-card-body mm-article-content">
        {{ conteudo_html }}
    </div>
</div>

<div class="mm-card mm-mt-4">
    <div class="mm-card-body">
        <div class="mm-flex mm-items-center mm-justify-between mm-flex-wrap mm-gap-4">
            <div>
                <strong>Este tutorial foi útil?</strong>
                <span class="mm-text-muted mm-ml-2">
                    <i class="bi bi-hand-thumbs-up"></i> {{ article.votos_util or 0 }}
                    <i class="bi bi-hand-thumbs-down mm-ml-2"></i> {{ article.votos_nao_util or 0 }}
                </span>
            </div>
            <div class="mm-flex mm-gap-2">
                <form method="post" action="{{ url_for('ajuda.votar_artigo', id=article.id) }}" style="display: inline;">
                    <input type="hidden" name="util" value="1">
                    <button type="submit" class="mm-btn {% if user_vote == 'util' %}mm-btn-primary{% else %}mm-btn-outline{% endif %}">
                        <i class="bi bi-hand-thumbs-up-fill"></i> Sim, foi útil
                    </button>
                </form>
                <form method="post" action="{{ url_for('ajuda.votar_artigo', id=article.id) }}" style="display: inline;">
                    <input type="hidden" name="util" value="0">
                    <button type="submit" class="mm-btn {% if user_vote == 'nao_util' %}mm-btn-danger{% else %}mm-btn-outline{% endif %}">
                        <i class="bi bi-hand-thumbs-down-fill"></i> Não foi útil
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

{% if current_user.nivel in ['admin', 'DEV'] %}
<div class="mm-flex mm-gap-2 mm-mt-4">
    <a href="{{ url_for('ajuda.editar_artigo', id=article.id) }}" class="mm-btn mm-btn-outline">
        <i class="bi bi-pencil"></i> Editar
    </a>
    <form method="post" action="{{ url_for('ajuda.excluir_artigo', id=article.id) }}" style="display: inline;">
        <button type="submit" class="mm-btn mm-btn-outline" style="color: var(--mm-danger);" onclick="return confirm('Excluir este tutorial?')">
            <i class="bi bi-trash"></i> Excluir
        </button>
    </form>
</div>
{% endif %}
{% endblock %}

{% block extra_css %}
<style>
.mm-article-content {
    line-height: 1.8;
    font-size: var(--mm-text-base);
}

.mm-article-content h1,
.mm-article-content h2,
.mm-article-content h3 {
    color: var(--mm-primary);
    margin-top: var(--mm-space-6);
    margin-bottom: var(--mm-space-4);
}

.mm-article-content h1 { font-size: 1.75rem; }
.mm-article-content h2 { font-size: 1.5rem; }
.mm-article-content h3 { font-size: 1.25rem; }

.mm-article-content p {
    margin-bottom: var(--mm-space-4);
}

.mm-article-content ul,
.mm-article-content ol {
    margin-bottom: var(--mm-space-4);
    padding-left: var(--mm-space-6);
}

.mm-article-content li {
    margin-bottom: var(--mm-space-2);
}

.mm-article-content strong {
    color: var(--mm-primary);
}

.mm-article-content code {
    background: var(--mm-bg-secondary);
    padding: 2px 6px;
    border-radius: 4px;
    font-family: monospace;
}
</style>
{% endblock %}
