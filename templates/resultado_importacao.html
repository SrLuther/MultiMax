{% extends 'base.html' %}
{% block title %}Resultado da Importação - MultiMax{% endblock %}
{% block content %}
<div class="mm-page-header mm-mb-6">
    <div>
        <h1 class="mm-page-title">Resultado da Importação</h1>
        <p class="mm-text-muted">Detalhes da importação de registros unificados</p>
    </div>
    <div class="mm-flex mm-gap-2">
        <a href="{{ url_for('relatorios.importar_registros_unificados') }}" class="mm-btn mm-btn-outline">
            <i class="bi bi-arrow-left"></i> Voltar
        </a>
        <a href="{{ url_for('relatorios.index') }}" class="mm-btn mm-btn-secondary">
            <i class="bi bi-house"></i> Início
        </a>
    </div>
</div>

<!-- Resumo -->
<div class="mm-grid mm-grid-cols-3 mm-gap-4 mm-mb-6">
    <div class="mm-card mm-kpi-card">
        <div class="mm-kpi-icon" style="background: rgba(16, 185, 129, 0.15); color: var(--mm-success);">
            <i class="bi bi-check-circle"></i>
        </div>
        <div class="mm-kpi-label">Importados</div>
        <div class="mm-kpi-value mm-text-success">{{ resultado.importados }}</div>
    </div>
    <div class="mm-card mm-kpi-card">
        <div class="mm-kpi-icon" style="background: rgba(239, 68, 68, 0.15); color: var(--mm-danger);">
            <i class="bi bi-x-circle"></i>
        </div>
        <div class="mm-kpi-label">Erros</div>
        <div class="mm-kpi-value mm-text-danger">{{ resultado.erros|length }}</div>
    </div>
    <div class="mm-card mm-kpi-card">
        <div class="mm-kpi-icon" style="background: rgba(59, 130, 246, 0.15); color: var(--mm-primary);">
            <i class="bi bi-list-ul"></i>
        </div>
        <div class="mm-kpi-label">Total Processado</div>
        <div class="mm-kpi-value">{{ resultado.total_linhas }}</div>
    </div>
</div>

<!-- Erros Detalhados -->
{% if resultado.erros %}
<div class="mm-card">
    <div class="mm-card-header">
        <h3 class="mm-card-title">
            <i class="bi bi-exclamation-triangle mm-text-danger"></i>
            Erros Encontrados ({{ resultado.erros|length }})
        </h3>
    </div>
    <div class="mm-card-body">
        <div class="mm-alert mm-alert-danger" style="margin-bottom: var(--mm-space-4);">
            <i class="bi bi-info-circle"></i>
            <div>
                <strong>Atenção:</strong> Os erros abaixo impediram a importação das respectivas linhas. 
                Corrija os dados no arquivo Excel e tente novamente.
            </div>
        </div>
        
        <div class="mm-table-wrapper">
            <table class="mm-table">
                <thead>
                    <tr>
                        <th style="width: 80px;">Linha</th>
                        <th>Erro</th>
                    </tr>
                </thead>
                <tbody>
                    {% for erro in resultado.erros %}
                    <tr>
                        <td>
                            <span class="mm-badge mm-badge-danger">{{ erro.split(':')[0] if ':' in erro else 'N/A' }}</span>
                        </td>
                        <td>
                            <code style="color: var(--mm-danger);">{{ erro.split(':', 1)[1] if ':' in erro else erro }}</code>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <div class="mm-mt-4">
            <a href="{{ url_for('relatorios.modelo_registros_unificados') }}" class="mm-btn mm-btn-outline">
                <i class="bi bi-download"></i> Baixar Modelo Novamente
            </a>
        </div>
    </div>
</div>
{% else %}
<div class="mm-card">
    <div class="mm-card-body">
        <div class="mm-empty-state">
            <i class="bi bi-check-circle-fill" style="color: var(--mm-success); font-size: 3rem;"></i>
            <h3>Importação Concluída com Sucesso!</h3>
            <p>Todos os {{ resultado.importados }} registro(s) foram importados sem erros.</p>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}










